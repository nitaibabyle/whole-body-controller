function zdot=rhs(t,z,tal1,tal2,tal3,tal4,tal5,homework)   

l1=homework.l1;
l2=homework.l2;
l3=homework.l3;
l4=homework.l4;
l5=homework.l5;

m1=homework.m1;
m2=homework.m2;
m3=homework.m3;
m4=homework.m4;
m5=homework.m5;

g=homework.g;
I1=homework.I1(3,3);
I2=homework.I2(3,3);
I3=homework.I3(3,3);


q1 = z(1);   dq1 = z(2);                         
q2 = z(3);   dq2 = z(4);    
q3 = z(5);   dq3 = z(6);                         
q4 = z(7);   dq4 = z(8); 
q5 = z(9);   dq5 = z(10);
q=[q1;q2;q3;q4;q5];
qd=[dq1;dq2;dq3;dq4;dq5];


M =[5*I3 + (l1^2*m1)/4 + l1^2*m2 + l1^2*m3 + (l2^2*m2)/4 + l1^2*m4 + l2^2*m3 + l1^2*m5 + l2^2*m4 + (l3^2*m3)/4 + l2^2*m5 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + l1*l5*m5*cos(q2 + q3 + q4 + q5) + l1*l3*m3*cos(q2 + q3) + 2*l1*l3*m4*cos(q2 + q3) + 2*l1*l3*m5*cos(q2 + q3) + l2*l4*m4*cos(q3 + q4) + 2*l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + l1*l2*m2*cos(q2) + 2*l1*l2*m3*cos(q2) + 2*l1*l2*m4*cos(q2) + 2*l1*l2*m5*cos(q2) + l2*l3*m3*cos(q3) + 2*l2*l3*m4*cos(q3) + 2*l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + l1*l4*m4*cos(q2 + q3 + q4) + 2*l1*l4*m5*cos(q2 + q3 + q4) + l2*l5*m5*cos(q3 + q4 + q5), 4*I3 + (l2^2*m2)/4 + l2^2*m3 + l2^2*m4 + (l3^2*m3)/4 + l2^2*m5 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l1*l3*m3*cos(q2 + q3))/2 + l1*l3*m4*cos(q2 + q3) + l1*l3*m5*cos(q2 + q3) + l2*l4*m4*cos(q3 + q4) + 2*l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l1*l2*m2*cos(q2))/2 + l1*l2*m3*cos(q2) + l1*l2*m4*cos(q2) + l1*l2*m5*cos(q2) + l2*l3*m3*cos(q3) + 2*l2*l3*m4*cos(q3) + 2*l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + l2*l5*m5*cos(q3 + q4 + q5), 3*I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l1*l3*m3*cos(q2 + q3))/2 + l1*l3*m4*cos(q2 + q3) + l1*l3*m5*cos(q2 + q3) + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l2*l3*m3*cos(q3))/2 + l2*l3*m4*cos(q3) + l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + (l2*l5*m5*cos(q3 + q4 + q5))/2, 2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + (l2*l5*m5*cos(q3 + q4 + q5))/2, I3 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2 + (l2*l5*m5*cos(q3 + q4 + q5))/2;
    4*I3 + (l2^2*m2)/4 + l2^2*m3 + l2^2*m4 + (l3^2*m3)/4 + l2^2*m5 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l1*l3*m3*cos(q2 + q3))/2 + l1*l3*m4*cos(q2 + q3) + l1*l3*m5*cos(q2 + q3) + l2*l4*m4*cos(q3 + q4) + 2*l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l1*l2*m2*cos(q2))/2 + l1*l2*m3*cos(q2) + l1*l2*m4*cos(q2) + l1*l2*m5*cos(q2) + l2*l3*m3*cos(q3) + 2*l2*l3*m4*cos(q3) + 2*l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + l2*l5*m5*cos(q3 + q4 + q5),                                                                                                                                                                                                                                                                 4*I3 + (l2^2*m2)/4 + l2^2*m3 + l2^2*m4 + (l3^2*m3)/4 + l2^2*m5 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + l2*l4*m4*cos(q3 + q4) + 2*l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + l2*l3*m3*cos(q3) + 2*l2*l3*m4*cos(q3) + 2*l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + l2*l5*m5*cos(q3 + q4 + q5),                                                                                                                                                                                 3*I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l2*l3*m3*cos(q3))/2 + l2*l3*m4*cos(q3) + l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                     2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                       I3 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2 + (l2*l5*m5*cos(q3 + q4 + q5))/2;
    3*I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l1*l3*m3*cos(q2 + q3))/2 + l1*l3*m4*cos(q2 + q3) + l1*l3*m5*cos(q2 + q3) + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l2*l3*m3*cos(q3))/2 + l2*l3*m4*cos(q3) + l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                       3*I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + l3*l5*m5*cos(q4 + q5) + (l2*l3*m3*cos(q3))/2 + l2*l3*m4*cos(q3) + l2*l3*m5*cos(q3) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                                                   3*I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + l3*l5*m5*cos(q4 + q5) + l3*l4*m4*cos(q4) + 2*l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5),                                                                                                                                                                                          2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5),                                                                        I3 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2;
    2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l1*l4*m4*cos(q2 + q3 + q4))/2 + l1*l4*m5*cos(q2 + q3 + q4) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                                                                                                                2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l2*l4*m4*cos(q3 + q4))/2 + l2*l4*m5*cos(q3 + q4) + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5) + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                                                                               2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l3*l4*m4*cos(q4))/2 + l3*l4*m5*cos(q4) + l4*l5*m5*cos(q5),                                                                                                                                                                                                                                                                2*I3 + (l4^2*m4)/4 + l4^2*m5 + (l5^2*m5)/4 + l4*l5*m5*cos(q5),                                                                                                    (m5*l5^2)/4 + (l4*m5*cos(q5)*l5)/2 + I3;
I3 + (l5^2*m5)/4 + (l1*l5*m5*cos(q2 + q3 + q4 + q5))/2 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2 + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    I3 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2 + (l2*l5*m5*cos(q3 + q4 + q5))/2,                                                                                                                                                                                                                                                                                                                                                                                                                               I3 + (l5^2*m5)/4 + (l3*l5*m5*cos(q4 + q5))/2 + (l4*l5*m5*cos(q5))/2,                                                                                                                                                                                                                                                                                      (m5*l5^2)/4 + (l4*m5*cos(q5)*l5)/2 + I3,                                                                                                                           (m5*l5^2)/4 + I3];
 
 
RHS =[tal1 - (g*l4*m4*cos(q1 + q2 + q3 + q4))/2 - g*l4*m5*cos(q1 + q2 + q3 + q4) - (g*l2*m2*cos(q1 + q2))/2 - g*l2*m3*cos(q1 + q2) - g*l2*m4*cos(q1 + q2) - g*l2*m5*cos(q1 + q2) - (g*l1*m1*cos(q1))/2 - g*l1*m2*cos(q1) - g*l1*m3*cos(q1) - g*l1*m4*cos(q1) - g*l1*m5*cos(q1) - (g*l5*m5*cos(q1 + q2 + q3 + q4 + q5))/2 - (g*l3*m3*cos(q1 + q2 + q3))/2 - g*l3*m4*cos(q1 + q2 + q3) - g*l3*m5*cos(q1 + q2 + q3) + (dq2^2*l1*l3*m3*sin(q2 + q3))/2 + dq2^2*l1*l3*m4*sin(q2 + q3) + (dq3^2*l1*l3*m3*sin(q2 + q3))/2 + dq2^2*l1*l3*m5*sin(q2 + q3) + dq3^2*l1*l3*m4*sin(q2 + q3) + dq3^2*l1*l3*m5*sin(q2 + q3) + (dq3^2*l2*l4*m4*sin(q3 + q4))/2 + dq3^2*l2*l4*m5*sin(q3 + q4) + (dq4^2*l2*l4*m4*sin(q3 + q4))/2 + dq4^2*l2*l4*m5*sin(q3 + q4) + (dq4^2*l3*l5*m5*sin(q4 + q5))/2 + (dq5^2*l3*l5*m5*sin(q4 + q5))/2 + (dq2^2*l1*l2*m2*sin(q2))/2 + dq2^2*l1*l2*m3*sin(q2) + dq2^2*l1*l2*m4*sin(q2) + dq2^2*l1*l2*m5*sin(q2) + (dq3^2*l2*l3*m3*sin(q3))/2 + dq3^2*l2*l3*m4*sin(q3) + dq3^2*l2*l3*m5*sin(q3) + (dq4^2*l3*l4*m4*sin(q4))/2 + dq4^2*l3*l4*m5*sin(q4) + (dq5^2*l4*l5*m5*sin(q5))/2 + (dq2^2*l1*l4*m4*sin(q2 + q3 + q4))/2 + dq2^2*l1*l4*m5*sin(q2 + q3 + q4) + (dq3^2*l1*l4*m4*sin(q2 + q3 + q4))/2 + dq3^2*l1*l4*m5*sin(q2 + q3 + q4) + (dq4^2*l1*l4*m4*sin(q2 + q3 + q4))/2 + dq4^2*l1*l4*m5*sin(q2 + q3 + q4) + (dq3^2*l2*l5*m5*sin(q3 + q4 + q5))/2 + (dq4^2*l2*l5*m5*sin(q3 + q4 + q5))/2 + (dq5^2*l2*l5*m5*sin(q3 + q4 + q5))/2 + (dq2^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 + (dq3^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 + (dq4^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 + (dq5^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 + dq1*dq2*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq1*dq3*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq1*dq4*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq2*dq3*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq1*dq5*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq2*dq4*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq2*dq5*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq3*dq4*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq3*dq5*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq4*dq5*l1*l5*m5*sin(q2 + q3 + q4 + q5) + dq1*dq2*l1*l3*m3*sin(q2 + q3) + 2*dq1*dq2*l1*l3*m4*sin(q2 + q3) + dq1*dq3*l1*l3*m3*sin(q2 + q3) + 2*dq1*dq2*l1*l3*m5*sin(q2 + q3) + 2*dq1*dq3*l1*l3*m4*sin(q2 + q3) + dq2*dq3*l1*l3*m3*sin(q2 + q3) + 2*dq1*dq3*l1*l3*m5*sin(q2 + q3) + 2*dq2*dq3*l1*l3*m4*sin(q2 + q3) + 2*dq2*dq3*l1*l3*m5*sin(q2 + q3) + dq1*dq3*l2*l4*m4*sin(q3 + q4) + 2*dq1*dq3*l2*l4*m5*sin(q3 + q4) + dq1*dq4*l2*l4*m4*sin(q3 + q4) + dq2*dq3*l2*l4*m4*sin(q3 + q4) + 2*dq1*dq4*l2*l4*m5*sin(q3 + q4) + 2*dq2*dq3*l2*l4*m5*sin(q3 + q4) + dq2*dq4*l2*l4*m4*sin(q3 + q4) + 2*dq2*dq4*l2*l4*m5*sin(q3 + q4) + dq3*dq4*l2*l4*m4*sin(q3 + q4) + 2*dq3*dq4*l2*l4*m5*sin(q3 + q4) + dq1*dq4*l3*l5*m5*sin(q4 + q5) + dq1*dq5*l3*l5*m5*sin(q4 + q5) + dq2*dq4*l3*l5*m5*sin(q4 + q5) + dq2*dq5*l3*l5*m5*sin(q4 + q5) + dq3*dq4*l3*l5*m5*sin(q4 + q5) + dq3*dq5*l3*l5*m5*sin(q4 + q5) + dq4*dq5*l3*l5*m5*sin(q4 + q5) + dq1*dq2*l1*l2*m2*sin(q2) + 2*dq1*dq2*l1*l2*m3*sin(q2) + 2*dq1*dq2*l1*l2*m4*sin(q2) + 2*dq1*dq2*l1*l2*m5*sin(q2) + dq1*dq3*l2*l3*m3*sin(q3) + 2*dq1*dq3*l2*l3*m4*sin(q3) + dq2*dq3*l2*l3*m3*sin(q3) + 2*dq1*dq3*l2*l3*m5*sin(q3) + 2*dq2*dq3*l2*l3*m4*sin(q3) + 2*dq2*dq3*l2*l3*m5*sin(q3) + dq1*dq4*l3*l4*m4*sin(q4) + 2*dq1*dq4*l3*l4*m5*sin(q4) + dq2*dq4*l3*l4*m4*sin(q4) + 2*dq2*dq4*l3*l4*m5*sin(q4) + dq3*dq4*l3*l4*m4*sin(q4) + 2*dq3*dq4*l3*l4*m5*sin(q4) + dq1*dq5*l4*l5*m5*sin(q5) + dq2*dq5*l4*l5*m5*sin(q5) + dq3*dq5*l4*l5*m5*sin(q5) + dq4*dq5*l4*l5*m5*sin(q5) + dq1*dq2*l1*l4*m4*sin(q2 + q3 + q4) + 2*dq1*dq2*l1*l4*m5*sin(q2 + q3 + q4) + dq1*dq3*l1*l4*m4*sin(q2 + q3 + q4) + 2*dq1*dq3*l1*l4*m5*sin(q2 + q3 + q4) + dq1*dq4*l1*l4*m4*sin(q2 + q3 + q4) + dq2*dq3*l1*l4*m4*sin(q2 + q3 + q4) + 2*dq1*dq4*l1*l4*m5*sin(q2 + q3 + q4) + 2*dq2*dq3*l1*l4*m5*sin(q2 + q3 + q4) + dq2*dq4*l1*l4*m4*sin(q2 + q3 + q4) + 2*dq2*dq4*l1*l4*m5*sin(q2 + q3 + q4) + dq3*dq4*l1*l4*m4*sin(q2 + q3 + q4) + 2*dq3*dq4*l1*l4*m5*sin(q2 + q3 + q4) + dq1*dq3*l2*l5*m5*sin(q3 + q4 + q5) + dq1*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq3*l2*l5*m5*sin(q3 + q4 + q5) + dq1*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq3*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq3*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq4*dq5*l2*l5*m5*sin(q3 + q4 + q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              tal2 - (g*l4*m4*cos(q1 + q2 + q3 + q4))/2 - g*l4*m5*cos(q1 + q2 + q3 + q4) - (g*l2*m2*cos(q1 + q2))/2 - g*l2*m3*cos(q1 + q2) - g*l2*m4*cos(q1 + q2) - g*l2*m5*cos(q1 + q2) - (g*l5*m5*cos(q1 + q2 + q3 + q4 + q5))/2 - (g*l3*m3*cos(q1 + q2 + q3))/2 - g*l3*m4*cos(q1 + q2 + q3) - g*l3*m5*cos(q1 + q2 + q3) - (dq1^2*l1*l3*m3*sin(q2 + q3))/2 - dq1^2*l1*l3*m4*sin(q2 + q3) - dq1^2*l1*l3*m5*sin(q2 + q3) + (dq3^2*l2*l4*m4*sin(q3 + q4))/2 + dq3^2*l2*l4*m5*sin(q3 + q4) + (dq4^2*l2*l4*m4*sin(q3 + q4))/2 + dq4^2*l2*l4*m5*sin(q3 + q4) + (dq4^2*l3*l5*m5*sin(q4 + q5))/2 + (dq5^2*l3*l5*m5*sin(q4 + q5))/2 - (dq1^2*l1*l2*m2*sin(q2))/2 - dq1^2*l1*l2*m3*sin(q2) - dq1^2*l1*l2*m4*sin(q2) - dq1^2*l1*l2*m5*sin(q2) + (dq3^2*l2*l3*m3*sin(q3))/2 + dq3^2*l2*l3*m4*sin(q3) + dq3^2*l2*l3*m5*sin(q3) + (dq4^2*l3*l4*m4*sin(q4))/2 + dq4^2*l3*l4*m5*sin(q4) + (dq5^2*l4*l5*m5*sin(q5))/2 - (dq1^2*l1*l4*m4*sin(q2 + q3 + q4))/2 - dq1^2*l1*l4*m5*sin(q2 + q3 + q4) + (dq3^2*l2*l5*m5*sin(q3 + q4 + q5))/2 + (dq4^2*l2*l5*m5*sin(q3 + q4 + q5))/2 + (dq5^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq1^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 + dq1*dq3*l2*l4*m4*sin(q3 + q4) + 2*dq1*dq3*l2*l4*m5*sin(q3 + q4) + dq1*dq4*l2*l4*m4*sin(q3 + q4) + dq2*dq3*l2*l4*m4*sin(q3 + q4) + 2*dq1*dq4*l2*l4*m5*sin(q3 + q4) + 2*dq2*dq3*l2*l4*m5*sin(q3 + q4) + dq2*dq4*l2*l4*m4*sin(q3 + q4) + 2*dq2*dq4*l2*l4*m5*sin(q3 + q4) + dq3*dq4*l2*l4*m4*sin(q3 + q4) + 2*dq3*dq4*l2*l4*m5*sin(q3 + q4) + dq1*dq4*l3*l5*m5*sin(q4 + q5) + dq1*dq5*l3*l5*m5*sin(q4 + q5) + dq2*dq4*l3*l5*m5*sin(q4 + q5) + dq2*dq5*l3*l5*m5*sin(q4 + q5) + dq3*dq4*l3*l5*m5*sin(q4 + q5) + dq3*dq5*l3*l5*m5*sin(q4 + q5) + dq4*dq5*l3*l5*m5*sin(q4 + q5) + dq1*dq3*l2*l3*m3*sin(q3) + 2*dq1*dq3*l2*l3*m4*sin(q3) + dq2*dq3*l2*l3*m3*sin(q3) + 2*dq1*dq3*l2*l3*m5*sin(q3) + 2*dq2*dq3*l2*l3*m4*sin(q3) + 2*dq2*dq3*l2*l3*m5*sin(q3) + dq1*dq4*l3*l4*m4*sin(q4) + 2*dq1*dq4*l3*l4*m5*sin(q4) + dq2*dq4*l3*l4*m4*sin(q4) + 2*dq2*dq4*l3*l4*m5*sin(q4) + dq3*dq4*l3*l4*m4*sin(q4) + 2*dq3*dq4*l3*l4*m5*sin(q4) + dq1*dq5*l4*l5*m5*sin(q5) + dq2*dq5*l4*l5*m5*sin(q5) + dq3*dq5*l4*l5*m5*sin(q5) + dq4*dq5*l4*l5*m5*sin(q5) + dq1*dq3*l2*l5*m5*sin(q3 + q4 + q5) + dq1*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq3*l2*l5*m5*sin(q3 + q4 + q5) + dq1*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq2*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq3*dq4*l2*l5*m5*sin(q3 + q4 + q5) + dq3*dq5*l2*l5*m5*sin(q3 + q4 + q5) + dq4*dq5*l2*l5*m5*sin(q3 + q4 + q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tal3 - (g*l4*m4*cos(q1 + q2 + q3 + q4))/2 - g*l4*m5*cos(q1 + q2 + q3 + q4) - (g*l5*m5*cos(q1 + q2 + q3 + q4 + q5))/2 - (g*l3*m3*cos(q1 + q2 + q3))/2 - g*l3*m4*cos(q1 + q2 + q3) - g*l3*m5*cos(q1 + q2 + q3) - (dq1^2*l1*l3*m3*sin(q2 + q3))/2 - dq1^2*l1*l3*m4*sin(q2 + q3) - dq1^2*l1*l3*m5*sin(q2 + q3) - (dq1^2*l2*l4*m4*sin(q3 + q4))/2 - dq1^2*l2*l4*m5*sin(q3 + q4) - (dq2^2*l2*l4*m4*sin(q3 + q4))/2 - dq2^2*l2*l4*m5*sin(q3 + q4) + (dq4^2*l3*l5*m5*sin(q4 + q5))/2 + (dq5^2*l3*l5*m5*sin(q4 + q5))/2 - (dq1^2*l2*l3*m3*sin(q3))/2 - dq1^2*l2*l3*m4*sin(q3) - (dq2^2*l2*l3*m3*sin(q3))/2 - dq1^2*l2*l3*m5*sin(q3) - dq2^2*l2*l3*m4*sin(q3) - dq2^2*l2*l3*m5*sin(q3) + (dq4^2*l3*l4*m4*sin(q4))/2 + dq4^2*l3*l4*m5*sin(q4) + (dq5^2*l4*l5*m5*sin(q5))/2 - (dq1^2*l1*l4*m4*sin(q2 + q3 + q4))/2 - dq1^2*l1*l4*m5*sin(q2 + q3 + q4) - (dq1^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq2^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq1^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 - dq1*dq2*l2*l4*m4*sin(q3 + q4) - 2*dq1*dq2*l2*l4*m5*sin(q3 + q4) + dq1*dq4*l3*l5*m5*sin(q4 + q5) + dq1*dq5*l3*l5*m5*sin(q4 + q5) + dq2*dq4*l3*l5*m5*sin(q4 + q5) + dq2*dq5*l3*l5*m5*sin(q4 + q5) + dq3*dq4*l3*l5*m5*sin(q4 + q5) + dq3*dq5*l3*l5*m5*sin(q4 + q5) + dq4*dq5*l3*l5*m5*sin(q4 + q5) - dq1*dq2*l2*l3*m3*sin(q3) - 2*dq1*dq2*l2*l3*m4*sin(q3) - 2*dq1*dq2*l2*l3*m5*sin(q3) + dq1*dq4*l3*l4*m4*sin(q4) + 2*dq1*dq4*l3*l4*m5*sin(q4) + dq2*dq4*l3*l4*m4*sin(q4) + 2*dq2*dq4*l3*l4*m5*sin(q4) + dq3*dq4*l3*l4*m4*sin(q4) + 2*dq3*dq4*l3*l4*m5*sin(q4) + dq1*dq5*l4*l5*m5*sin(q5) + dq2*dq5*l4*l5*m5*sin(q5) + dq3*dq5*l4*l5*m5*sin(q5) + dq4*dq5*l4*l5*m5*sin(q5) - dq1*dq2*l2*l5*m5*sin(q3 + q4 + q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              tal4 - (g*l4*m4*cos(q1 + q2 + q3 + q4))/2 - g*l4*m5*cos(q1 + q2 + q3 + q4) - (g*l5*m5*cos(q1 + q2 + q3 + q4 + q5))/2 - (dq1^2*l2*l4*m4*sin(q3 + q4))/2 - dq1^2*l2*l4*m5*sin(q3 + q4) - (dq2^2*l2*l4*m4*sin(q3 + q4))/2 - dq2^2*l2*l4*m5*sin(q3 + q4) - (dq1^2*l3*l5*m5*sin(q4 + q5))/2 - (dq2^2*l3*l5*m5*sin(q4 + q5))/2 - (dq3^2*l3*l5*m5*sin(q4 + q5))/2 - (dq1^2*l3*l4*m4*sin(q4))/2 - dq1^2*l3*l4*m5*sin(q4) - (dq2^2*l3*l4*m4*sin(q4))/2 - dq2^2*l3*l4*m5*sin(q4) - (dq3^2*l3*l4*m4*sin(q4))/2 - dq3^2*l3*l4*m5*sin(q4) + (dq5^2*l4*l5*m5*sin(q5))/2 - (dq1^2*l1*l4*m4*sin(q2 + q3 + q4))/2 - dq1^2*l1*l4*m5*sin(q2 + q3 + q4) - (dq1^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq2^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq1^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 - dq1*dq2*l2*l4*m4*sin(q3 + q4) - 2*dq1*dq2*l2*l4*m5*sin(q3 + q4) - dq1*dq2*l3*l5*m5*sin(q4 + q5) - dq1*dq3*l3*l5*m5*sin(q4 + q5) - dq2*dq3*l3*l5*m5*sin(q4 + q5) - dq1*dq2*l3*l4*m4*sin(q4) - 2*dq1*dq2*l3*l4*m5*sin(q4) - dq1*dq3*l3*l4*m4*sin(q4) - 2*dq1*dq3*l3*l4*m5*sin(q4) - dq2*dq3*l3*l4*m4*sin(q4) - 2*dq2*dq3*l3*l4*m5*sin(q4) + dq1*dq5*l4*l5*m5*sin(q5) + dq2*dq5*l4*l5*m5*sin(q5) + dq3*dq5*l4*l5*m5*sin(q5) + dq4*dq5*l4*l5*m5*sin(q5) - dq1*dq2*l2*l5*m5*sin(q3 + q4 + q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             tal5 - (g*l5*m5*cos(q1 + q2 + q3 + q4 + q5))/2 - (dq1^2*l3*l5*m5*sin(q4 + q5))/2 - (dq2^2*l3*l5*m5*sin(q4 + q5))/2 - (dq3^2*l3*l5*m5*sin(q4 + q5))/2 - (dq1^2*l4*l5*m5*sin(q5))/2 - (dq2^2*l4*l5*m5*sin(q5))/2 - (dq3^2*l4*l5*m5*sin(q5))/2 - (dq4^2*l4*l5*m5*sin(q5))/2 - (dq1^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq2^2*l2*l5*m5*sin(q3 + q4 + q5))/2 - (dq1^2*l1*l5*m5*sin(q2 + q3 + q4 + q5))/2 - dq1*dq2*l3*l5*m5*sin(q4 + q5) - dq1*dq3*l3*l5*m5*sin(q4 + q5) - dq2*dq3*l3*l5*m5*sin(q4 + q5) - dq1*dq2*l4*l5*m5*sin(q5) - dq1*dq3*l4*l5*m5*sin(q5) - dq1*dq4*l4*l5*m5*sin(q5) - dq2*dq3*l4*l5*m5*sin(q5) - dq2*dq4*l4*l5*m5*sin(q5) - dq3*dq4*l4*l5*m5*sin(q5) - dq1*dq2*l2*l5*m5*sin(q3 + q4 + q5)];
qdd= M \ RHS;
zdot=[qd(1) qdd(1) qd(2) qdd(2) qd(3) qdd(3) qd(4) qdd(4) qd(5) qdd(5)]';

